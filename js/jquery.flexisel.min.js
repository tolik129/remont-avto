(function(a){a.fn.flexisel=function(n){var g=a.extend({visibleItems:4,itemsToScroll:3,animationSpeed:400,infinite:true,navigationTargetSelector:null,autoPlay:{enable:false,interval:5000,pauseOnHover:true},responsiveBreakpoints:{portrait:{changePoint:480,visibleItems:1,itemsToScroll:1},landscape:{changePoint:640,visibleItems:2,itemsToScroll:2},tablet:{changePoint:768,visibleItems:3,itemsToScroll:3}},loaded:function(){},before:function(){},after:function(){},resize:function(){}},n);var h=a(this);var e=a.extend(g,n);var j;var k=true;var b;var i=e.visibleItems;var f=e.itemsToScroll;var c=[];var m;var l;var d={init:function(){return this.each(function(){d.appendHTML();d.setEventHandlers();d.initializeItems()})},initializeItems:function(){var q=e.responsiveBreakpoints;for(var p in q){c.push(q[p])}c.sort(function(s,r){return s.changePoint-r.changePoint});var o=h.children();o.first().addClass("index");j=d.getCurrentItemWidth();b=o.length;o.width(j);if(e.infinite){d.offsetItemsToBeginning(Math.floor(o.length/2));h.css({left:-j*Math.floor(o.length/2)})}a(window).trigger("resize");h.fadeIn();e.loaded.call(this,h)},appendHTML:function(){h.addClass("nbs-flexisel-ul");h.wrap("<div class='nbs-flexisel-container'><div class='nbs-flexisel-inner'></div></div>");h.find("li").addClass("nbs-flexisel-item");if(e.navigationTargetSelector&&a(e.navigationTargetSelector).length>0){a("<div class='nbs-flexisel-nav-left'></div><div class='nbs-flexisel-nav-right'></div>").appendTo(e.navigationTargetSelector)}else{e.navigationTargetSelector=h.parent();a("<div class='nbs-flexisel-nav-left'></div><div class='nbs-flexisel-nav-right'></div>").insertAfter(h)}if(e.infinite){var q=h.children();var p=q.clone();var o=q.clone();h.prepend(p);h.append(o)}},setEventHandlers:function(){var p=this;var o=h.children();a(window).on("resize",function(q){k=false;clearTimeout(m);m=setTimeout(function(){k=true;d.calculateDisplay();j=d.getCurrentItemWidth();o.width(j);if(e.infinite){h.css({left:-j*Math.floor(o.length/2)})}else{d.clearDisabled();a(e.navigationTargetSelector).find(".nbs-flexisel-nav-left").addClass("disabled");h.css({left:0})}e.resize.call(p,h)},100)});a(e.navigationTargetSelector).find(".nbs-flexisel-nav-left").on("click",function(q){d.scroll(true)});a(e.navigationTargetSelector).find(".nbs-flexisel-nav-right").on("click",function(q){d.scroll(false)});if(e.autoPlay.enable){d.setAutoplayInterval();if(e.autoPlay.pauseOnHover===true){h.on({mouseenter:function(){k=false},mouseleave:function(){k=true}})}}h[0].addEventListener("touchstart",d.touchHandler.handleTouchStart,false);h[0].addEventListener("touchmove",d.touchHandler.handleTouchMove,false)},calculateDisplay:function(){var o=a("html").width();var q=c[c.length-1].changePoint;for(var p in c){if(o>=q){i=e.visibleItems;f=e.itemsToScroll;break}else{if(o<c[p].changePoint){i=c[p].visibleItems;f=c[p].itemsToScroll;break}else{continue}}}},scroll:function(p){if(typeof p==="undefined"){p=true}if(k==true){k=false;e.before.call(this,h);j=d.getCurrentItemWidth();if(e.autoPlay.enable){clearInterval(l)}if(!e.infinite){var o=j*f;if(p){h.animate({left:d.calculateNonInfiniteLeftScroll(o)},e.animationSpeed,function(){e.after.call(this,h);k=true})}else{h.animate({left:d.calculateNonInfiniteRightScroll(o)},e.animationSpeed,function(){e.after.call(this,h);k=true})}}else{h.animate({left:p?"+="+j*f:"-="+j*f},e.animationSpeed,function(){e.after.call(this,h);k=true;if(p){d.offsetItemsToBeginning(f)}else{d.offsetItemsToEnd(f)}d.offsetSliderPosition(p)})}if(e.autoPlay.enable){d.setAutoplayInterval()}}},touchHandler:{xDown:null,yDown:null,handleTouchStart:function(o){this.xDown=o.touches[0].clientX;this.yDown=o.touches[0].clientY},handleTouchMove:function(o){if(!this.xDown||!this.yDown){return}var r=o.touches[0].clientX;var p=o.touches[0].clientY;var s=this.xDown-r;var q=this.yDown-p;if(Math.abs(s)>0){if(s>0){d.scroll(false)}else{d.scroll(true)}}this.xDown=null;this.yDown=null;k=true}},getCurrentItemWidth:function(){return(h.parent().width())/i},offsetItemsToBeginning:function(p){if(typeof p==="undefined"){p=1}for(var o=0;o<p;o++){h.children().last().insertBefore(h.children().first())}},offsetItemsToEnd:function(p){if(typeof p==="undefined"){p=1}for(var o=0;o<p;o++){h.children().first().insertAfter(h.children().last())}},offsetSliderPosition:function(o){var p=parseInt(h.css("left").replace("px",""));if(o){p=p-j*f}else{p=p+j*f}h.css({left:p})},getOffsetPosition:function(){return parseInt(h.css("left").replace("px",""))},calculateNonInfiniteLeftScroll:function(o){d.clearDisabled();if(d.getOffsetPosition()+o>=0){a(e.navigationTargetSelector).find(".nbs-flexisel-nav-left").addClass("disabled");return 0}else{return d.getOffsetPosition()+o}},calculateNonInfiniteRightScroll:function(o){d.clearDisabled();var p=(b*j)-(i*j);if(d.getOffsetPosition()-o<=-p){a(e.navigationTargetSelector).find(".nbs-flexisel-nav-right").addClass("disabled");return -p}else{return d.getOffsetPosition()-o}},setAutoplayInterval:function(){l=setInterval(function(){if(k){d.scroll(false)}},e.autoPlay.interval)},clearDisabled:function(){var o=a(e.navigationTargetSelector);o.find(".nbs-flexisel-nav-left").removeClass("disabled");o.find(".nbs-flexisel-nav-right").removeClass("disabled")}};if(d[n]){return d[n].apply(this,Array.prototype.slice.call(arguments,1))}else{if(typeof n==="object"||!n){return d.init.apply(this)}else{a.error('Method "'+method+'" does not exist in flexisel plugin!')}}}})(jQuery);